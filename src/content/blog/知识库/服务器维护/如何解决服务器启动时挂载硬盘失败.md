---
title: 如何解决服务器启动时挂载硬盘失败
date: 2024-10-20T14:03:12+08:00
updated: 2024-11-13T10:46:30+08:00
permalink: /linux/fstab-fail/
tags:
  - 服务器
  - 运维
ccby: true
draft: false
comments: true
no-rss: false
---

一般来说服务器启动时挂载硬盘失败以后是无法登陆的，这个时候你需要通过管理终端来访问服务器，比如 PVE 后台、exsi 后台，如果是云服务器厂商则有各自的后台，如果是物理机器则需要链接显示器和键盘。

# 问题原因

一般来说出现这个问题是设置的 `/etc/fstab` 有问题导致的，fstab 储存了服务器磁盘挂载的全部信息，默认情况下会等待一盘挂载成功才会进入系统，如果单次失败以后，则会尝试重复启动。


# 解决方案

## 1. 启动 recover 模式

在进入系统时，选择 recover 模式，随后按 e 按键进入 grub 引导文件。

![](https://cdn.iceprosurface.com/upload/md/202411131042604.png)

随后查找 linux 启动命令如：

```
linux xxxxxx
linux16 xxxx
```

等字样的文字，在该行最后添加 `rw init=/bin/bash` ，按下 ctrl+x 启动并进入。

## 2. 修改 fstab

通常你可以在启动时看到挂载失败的路径，譬如我的是

+ /mnt/sda
+ /mnt/sdb

如果目标启动的硬盘还未插入，你可以选择在 fstab 中添加 nofail 来解决

```txt /nofail/
/dev/sdb /mnt/sdb ext4 defaults,nofail 0 0
/dev/sdc1 /mnt/sdc1 ext3 defaults,nofail 0 0
```

如果硬盘已经删除，那么可以选择删除这几行即可

> [!attention] 切记
> 在操作 fstab 时，建议首先备份一次 fstab 譬如： cp /etc/fstab /etc/fstab.back
> 防止意外删除配置以后无法找回

