---
title: è™šæ‹Ÿ dom
date: 2024-07-17T13:58:53+08:00
updated: 2024-08-01T18:09:24+08:00
permalink: /code/front-end/vdom/
tags:
  - å‰ç«¯
ccby: true
draft: false
comments: true
no-rss: false
---

# ç¼˜èµ·

åœ¨æœ€æ—©çš„æ—¶å€™ï¼Œå‰ç«¯æ˜¯ **æ²¡æœ‰ vdom** çš„ï¼Œäº‹å®ä¸Šä¼ ç»Ÿçš„å‰ç«¯å¼€å‘å¾€å¾€ä¾èµ–äº <u>å­—ç¬¦ä¸²æ‹¼æ¥</u> æ¥å®Œæˆè§†å›¾å±‚çš„åˆ·æ–°ï¼Œè­¬å¦‚ä¸‹é¢è¿™æ ·çš„ä»£ç ï¼š

```ts
$('#app').click(() => {
  const text = "clicked"
  $('.button').html(`<span>${text}</span>`)
});
```

> [!failure] ä»¥ä¸Šä»£ç ä¸ºä¼ªä»£ç ï¼Œå¹¶ **ä¸èƒ½å®é™…è¿è¡Œ**

å¤§çº¦åœ¨ 2010å¹´å¼€å§‹ï¼Œé™†ç»­å°±æœ‰ä¸åŒçš„æ¡†æ¶ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œä½¿ç”¨äº†ä¸åŒçš„æ–¹å¼å» *ç®€åŒ–* è¿™äº›æ“ä½œï¼š

+ string template æ´¾ç³»
	+ backbone.js
	+ angular.js
+ dom template æ´¾ç³»
	+ Vue1
	+ Knockout.js

è¿™äº›å‰ç«¯æ¡†æ¶ **å¤šå¤šå°‘å°‘è§£å†³äº†ä¸€äº›é—®é¢˜**ï¼Œä½†æ˜¯ **å®è´¨ä¸Š** æ²¡æœ‰çœŸæ­£çš„æŠŠ render å±‚çš„äº‹æƒ…çº³å…¥è€ƒè™‘ã€‚

ç›´åˆ° 2013 å¹´å·¦å³ï¼Œreact å¼€å§‹æ€è€ƒè¿™ä¸ªç»å…¸çš„é—®é¢˜æ—¶æ‰å¾—å‡ºä¸€ä¸ªç­”æ¡ˆ[^4]ï¼š

> [!question] Pete Huntï¼šReactï¼šé‡æ–°æ€è€ƒå…¸èŒƒå®ä¾‹çš„æ„ä¹‰â€” JSConf EU
> â€œRerender on every changeï¼Ÿ That seemes expensiveâ€

# vdom çš„è¯ç”Ÿ

vdom çš„è¯ç”Ÿæ˜¯å› ä¸º *ä¸¤ä¸ªå…³é”®çš„æ€è€ƒ*ï¼š

1. å£°æ˜å¼æ¡†æ¶çš„æ¶Œç°ï¼Œä½¿å¾—æ“ä½œ dom çš„é€»è¾‘å˜æˆäº†å£°æ˜å¼çš„ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥è®© <u>æ•°æ®é©±åŠ¨æ¸²æŸ“</u>ï¼Œè®©æ•°æ®å’Œæ¸²æŸ“ç›´æ¥æŒ‚é’©
2. dom çš„æ“ä½œå·²ç»é›†ä¸­é€šè¿‡æ¡†æ¶å¤„ç†äº†ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯æ¡†æ¶å¯ä»¥å» <u>æ‰¹å¤„ç†</u> dom æ¥å‡å°‘æ€§èƒ½ã€‚

## å£°æ˜å¼ä¸æ•°æ®ç»‘å®š

æˆ‘ä»¬å¯ä»¥ç®€å•çš„ä¸¾ä¸€ä¸ª vue1 çš„ä¾‹å­ï¼š

```html
<div id="app">
	<h1>{{ message }}</h1>
	<input v-model="message" />
</div>
<script>
	// åˆ›å»ºä¸€ä¸ª Vue å®ä¾‹
	var app = new Vue({
		el: '#app',
		data: {
			message: 'Hello Vue.js 1.x!'
		}
	});
</script>
```

vue1 æ—©æœŸåœ¨è®¾è®¡ä¸Šå¯ä»¥ç›´æ¥çš„æ›¿æ¢ jqueryï¼Œä»–çš„å“åº”å¼é€»è¾‘åœ¨è®¾è®¡ä¸Š **æä¸ºå…ˆè¿›**ï¼Œä½†æ˜¯ **å……æ»¡é­”æ³•**ã€‚åˆ©ç”¨ defineProperty ç»‘å®šå˜æ›´å¸¦æ¥æ–¹ä¾¿æ“ä½œèƒ½åŠ›ã€‚

ä½†æ˜¯ä»–æ²¡æœ‰è§£å†³æ¸²æŸ“æ€§èƒ½çš„é—®é¢˜ï¼Œvue1 ä¸­æ˜¯å®Œå…¨æ²¡æœ‰è™šæ‹Ÿ domï¼Œæ‰€ä»¥åœ¨è¾ƒå¤§è§„æ¨¡çš„é¡¹ç›®ä¸­ï¼Œå…¶åˆ·æ–°æ€§èƒ½éå¸¸ç³Ÿç³•ï¼Œå¥½åœ¨ react çš„å®ç°ç»™å¤§å®¶æŒ‡å‡ºäº†ä¸€æ¡æ˜è·¯ã€‚

## è™šæ‹Ÿ dom çš„è¯ç”Ÿ

è™šæ‹Ÿdom æ­£æ˜¯åœ¨è¿™æ ·çš„åœºæ™¯ä¸‹è¯ç”Ÿçš„ï¼Œæœ‰å¥è¯è¯´çš„å¥½ [^1]ï¼š

> [!quote] David Wheeler
> All problems in computer science can be solved by another level of indirection

æˆ‘ä»¬å¤§å¯åŠ ä¸ª *ä¸­é—´å±‚* æ¥è§£å†³è¿™ä¸ªé—®é¢˜æŠŠï¼š`ä»£ç  -> dom`ï¼Œå˜ä¸º `ä»£ç ->vdom->dom`

è®©æŒæœ‰ vdom çš„å¼•æ“å»è§£å†³ä»€ä¹ˆæ—¶å€™ **æ‰¹é‡æ›´æ–° dom** å°±å¯ä»¥äº†ï¼Œè¿™å¹¶ä¸æ˜¯éš¾äº‹ï¼Œå¥½å¤„æ˜¯ *æ˜¾è€Œæ˜“è§* çš„ï¼š

1. è·¨å¹³å°ï¼Œvdom å®ç°å¯ä»¥æŠ½è±¡ï¼Œä¸”åœ¨ä»»ä½•å¹³å°ä½¿ç”¨
2. å‡å°‘æ›´æ–°ï¼Œå°†å¤šæ¬¡æ“ä½œåˆå¹¶ä¸ºå•æ¬¡
3. js æ¯” dom å¿«å¾ˆå¤šï¼Œdiff å‡ºæœ€å°çš„ dom å˜æ›´æ¥å‡å° dom æ›´æ–°æˆæœ¬ï¼Œå‡å°‘ reflow

åœ¨ç»“åˆå£°æ˜å¼æ•°æ®ç»‘å®š+ vdom åï¼Œreact å‡‘é½äº†ä¸¤å—æœ€å¤§çš„æ¡†æ¶ç¢ç‰‡ï¼Œåœ¨å‰ç«¯æ¡†æ¶çš„è·¯ä¸Šä¸€éª‘ç»å°˜ï¼Œé¥é¥é¢†å…ˆã€‚

ä½†æ˜¯ vdom çœŸçš„ä¸€ç‚¹é—®é¢˜éƒ½æ²¡æœ‰ä¹ˆï¼Ÿ

# vdom åŠ£åŠ¿

vdom å¯¹æ¯”ç›´æ¥æ“ä½œ dom æ˜¾ç„¶æ˜¯æœ‰æˆæœ¬çš„ï¼š

+ å½“é¦–æ¬¡æ¸²æŸ“æ—¶ï¼Œä¼šæœ‰å¤§é‡çš„ vdom å¯¹è±¡ç”Ÿæˆï¼Œæ˜¾ç„¶æ¯” ç›´æ¥ innerHTML æ’å…¥æ…¢
+ æ›´å¤§çš„å†…å­˜æ¶ˆè€—
+ æ›´æ–°è¶Šé¢‘ç¹ã€diff è¶Šé¢‘ç¹ï¼Œè®¡ç®—æ—¶é—´é•¿

ä¸ºäº†è§£å†³è¿™äº› vdom çš„ç¼ºé™·ï¼Œå¤§è‡´æœ‰å››æ´¾ï¼š

## åŸæ•™æ—¨ä¸»ä¹‰

åŸæ•™æ—¨ä¸»ä¹‰è€…é€šå¸¸æ˜¯ react æ´¾ç³»çš„ç»å¯¹æ‹¥è¶¸ï¼Œä»–ä»¬è®¤ä¸º react çš„æ€§èƒ½å¹¶ä¸æ˜¯å¤§çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¤§å¯ç”¨ shouldComponentUpdate æ¥è§£å†³ [^2]ã€‚

> [!attention] ç»æ€
> ä½ å¾—æ‰¿è®¤ï¼Œå¦‚æœç”¨æˆ·èƒ½è‡ªå·± cover æ‰é—®é¢˜ï¼Œé‚£é—®é¢˜æ˜¾ç„¶ä¸æ˜¯é—®é¢˜ã€‚


## ä¸­ç«‹æ´¾â€”æ—¶é—´ä¼šæŠ¹å¹³ä¸€åˆ‡

> Time's glory is to calm contending kings, to unmask falsehood, and bring truth to light.
> -> William Shakespeare

æ—¶é—´ä¼šå†²åˆ·ä¸€åˆ‡ï¼Œæ‰€ä»¥ react å†³å®šç”¨å¤æ‚çš„ fiberï¼Œé€šè¿‡å¯¹ä¸åŒäº‹ä»¶åˆ’åˆ†çš„ä¼˜å…ˆçº§ï¼ˆlane æ¨¡å‹ï¼‰çš„æ‰“æ–­æœºåˆ¶æœ‰ä¸€å®šç¨‹åº¦çš„æ”¹å–„ä¸»çº¿ç¨‹å¡é¡¿çš„ç°è±¡ã€‚

å¯¹æ­¤ï¼Œæˆ‘æ›´æ„¿æ„ç§°å‘¼å…¶ä¸º â€œ[é¸µé¸Ÿç­–ç•¥](../../å…¶ä»–/é¸µé¸Ÿæ–¹æ¡ˆ.md)â€ ï¼Œå½“ç„¶æ€»ä½“æ˜¯æœ‰ç”¨çš„ã€‚

> [!done] æŠ±å¤´é¼ çªœ
> ä½ å¡çš„äº†ä¸€æ—¶ï¼Œå¡çš„äº†ä¸€ä¸–ä¹ˆï¼Ÿ

## å®šå‘æ›´æ–°

å®šå‘æ›´æ–°æ˜¯ vue æ´¾ç³»ä¸­çš„ä¿å®ˆè€…ï¼Œä»–ä»¬é€‰æ‹©ä½¿ç”¨ç»†ç²’åº¦çš„çŠ¶æ€æ§åˆ¶æ¥å®šå‘çš„è§¦å‘æ›´æ–°ï¼Œæœ¬è´¨ä¸Šä»–ä»¬å’Œæ¿€è¿›æ´¾çš„å®ç°å¹¶æ— å·®åˆ«ï¼Œæœ€å¤§çš„åŒºåˆ«åªæ˜¯ä»–ä»¬è¿˜åœ¨å›ºå®ˆ vdom çš„å¤§æ——è€Œå·²ã€‚

å¯¹æ¯”ç²—ç³™çš„ react æ›´æ–° ï¼Œvue3 ä¸­çš„æ›´æ–°æ€»æ˜¯èƒ½ç›´æ¥çš„è§¦åŠ component ä¸­ç›¸å¯¹è¾ƒå°çš„ä¸€å— domã€‚

## æ¿€è¿›æ´¾

æ¿€è¿›æ´¾æ˜¯2022å¹´å¼€å§‹å‡ºç°çš„ä¸€äº›æ–°æ´¾ç³»ï¼Œä¾‹å¦‚å›½å†…å¸¸å¸¸æ´—è„‘å®£ä¼ çš„ vue vapor æ¨¡å¼å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„æ¿€è¿›æ´¾ï¼Œå¯¹æ¯”ä»–çš„è€å¸ˆï¼ˆsolid-jsï¼‰å¯ä»¥ç”¨ä¸‹é¢è¿™æ®µå¯¹è¯ç²¾ç¡®æè¿°[^3]ï¼š

> [!question]  ä»€ä¹ˆä½ ä¸ç”¨ vdom äº†ï¼Ÿ
>solidjs: reactï¼js çš„æ€§èƒ½æ˜¯æœ‰æé™çš„ï¼Œè¶Šæ˜¯ç©å¼„æ—¶é—´åˆ‡ç‰‡å’Œ diffï¼Œå°±è¶Šä¼šè§¦åŠæé™â€¦â€¦é™¤éæˆä¸ºè¶…è¶Š vdom çš„å­˜åœ¨
> 
> reactã€vue:  solid ä½ åˆ°åº•è¦è¯´ä»€ä¹ˆï¼Ÿ
>
>solidjsï¼š æˆ‘ä¸è¦ vdom æ‹‰ï¼

# å»è™šæ‹Ÿ dom åŒ–

ç°é˜¶æ®µçš„æ—  vdom å¤§å†›å¤§è‡´æœ‰ä¸‰ä¸ªï¼Œé™¤å¼€ vueï¼Œå¦å¤–ä¸¤è€…éƒ½å·²ç»è¾ƒä¸ºæˆç†Ÿï¼Œä½†ä»–ä»¬çš„ä½¿ç”¨é‡é¥é¥è½åï¼Œæœªæ¥å¯è§çš„æ˜¯å¤§æ¦‚ç‡ vue å°†ä¼šæ˜¯æ—  vdom å¤§å†›çš„ä¸»åŠ›ã€‚

+ svelte
+ solid
+ vue vapor

### svelte

svelte æ˜¯ rollup çš„ä½œè€… Rich Harris å¼€å‘çš„ï¼Œä»–æ¯”è¾ƒå–œæ¬¢ `the best API is no API at all ` è¿™ä¸ªé€»è¾‘ï¼Œæ‰€ä»¥å¹²è„†ä¸€ç‚¹ï¼Œç›´æ¥ç”¨æ¨¡æ¿ç¼–è¯‘æˆå®šå‘æ›´æ–°ä»£ç å¥½äº†ï¼š

```html
<script>
	let name = 'world';
	function click () {
		name += 1
	}
</script>

<h1>Hello {name}!</h1>
<button on:click={click}>click</button>
```

ä¾‹å¦‚è¿™ä¸ªä»£ç ä¼šå¤§è‡´ç¼–è¯‘æˆä¸‹é¢è¿™æ ·ï¼š

```typescript
function create_fragment(ctx) {
	let div;
	let h1;
	let t0;
	let t1;
	let t2;
	let t3;
	let button;
	let mounted;
	let dispose;

	const block = {
		c: function create() {
			div = element("div");
			h1 = element("h1");
			t0 = text("Hello ");
			t1 = text(/*name*/ ctx[0]);
			t2 = text("!");
			t3 = space();
			button = element("button");
			button.textContent = "click";
			add_location(h1, file, 7, 1, 83);
			add_location(button, file, 8, 1, 107);
			add_location(div, file, 6, 0, 76);
		},
		l: function claim(nodes) {
			throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option");
		},
		m: function mount(target, anchor) {
			insert_dev(target, div, anchor);
			append_dev(div, h1);
			append_dev(h1, t0);
			append_dev(h1, t1);
			append_dev(h1, t2);
			append_dev(div, t3);
			append_dev(div, button);

			if (!mounted) {
				dispose = listen_dev(button, "click", /*click*/ ctx[1], false, false, false, false);
				mounted = true;
			}
		},
		p: function update(ctx, [dirty]) {
			if (dirty & /*name*/ 1) set_data_dev(t1, /*name*/ ctx[0]);
		},
		i: noop,
		o: noop,
		d: function destroy(detaching) {
			if (detaching) {
				detach_dev(div);
			}

			mounted = false;
			dispose();
		}
	};

	dispatch_dev("SvelteRegisterBlock", {
		block,
		id: create_fragment.name,
		type: "component",
		source: "",
		ctx
	});
	return block;
}
function instance($$self, $$props, $$invalidate) {
	let name = 'world';
	function click() {
		$$invalidate(0, name += 1);
	}
	return [name, click];
}

```

ä¸Šé¢çš„ ` set_data_dev(t1, /*name*/ ctx[0]);` å°±å®ç°äº†å®šå‘æ›´æ–°çš„é€»è¾‘ã€‚è€Œå“åº”å¼æ•°æ®æ–¹é¢åˆ™é€šè¿‡ `$$invalidate` å®ç°äº†è¿½è¸ªã€‚

å¾ˆæœ‰æ„æ€çš„ç¼–è¯‘æ€è·¯ï¼Œä½†æ˜¯ç¼–è¾‘å™¨çš„æç¤ºè¯´ä¸ä¸Šå¤ªå¥½ã€‚åœ¨å°é¡¹ç›®ä¸Šè¿˜æ˜¯ç”¨èµ·æ¥å¾ˆä¸é”™çš„ã€‚

### vue vapor

å°¤é›¨æºªæ­¤å‰æ˜¯å•ç‹¬åœ¨çŸ¥ä¹å¼€è´´è°ˆäº†è°ˆè™šæ‹Ÿ DOM çš„é—®é¢˜çš„[^5], ä»æˆ‘çš„è§’åº¦æ¥è®² vue å¼•å…¥ vdom æ˜¾ç„¶æ˜¯ä¸€ä¸ªéå¸¸è‡ªç„¶çš„äº‹æƒ…ï¼Œå¾ˆç†è§£ vue åšçš„è¿™ä¸ªäº‹æƒ…ã€‚

> [!quote] å°¤é›¨æºª
> React çš„ vdom å…¶å®æ€§èƒ½ä¸æ€ä¹ˆæ ·ã€‚Vue 2.0 å¼•å…¥ vdom çš„ä¸»è¦åŸå› æ˜¯ vdom æŠŠæ¸²æŸ“è¿‡ç¨‹æŠ½è±¡åŒ–äº†ï¼Œä»è€Œä½¿å¾—ç»„ä»¶çš„æŠ½è±¡èƒ½åŠ›ä¹Ÿå¾—åˆ°æå‡ï¼Œå¹¶ä¸”å¯ä»¥é€‚é… DOM ä»¥å¤–çš„æ¸²æŸ“ç›®æ ‡ã€‚è¿™ä¸€ç‚¹æ˜¯å€Ÿé‰´ React æ¯«æ— äº‰è®®  

æˆ‘å¯¹æ­¤æ€»ä½“æ˜¯èµåŒçš„ï¼Œæœ¬èº«æ ‡è®°æ€§æå¼ºçš„ sfc è‚¯å®šæ˜¯éœ€è¦ä¸€ä¸ªä¸­é—´è®¾æ–½æ¥å®ŒæˆæŠ½è±¡çš„ï¼Œå¹¶ä¸”å¯¹äº vue çš„ vapor mode æ€»ä½“æ˜¯ä¹è§‚çš„ã€‚

åœ¨ 2022 å¹´çš„æ—¶å€™æ˜é‡‘çš„ç¨€åœŸå¼€å‘è€…å¤§ä¼šä¸Šï¼Œå°¤é›¨æºªå°±å¯¹æ­¤æœ‰è¿‡è¯¦ç»†çš„é˜è¿°[^6]ï¼š 

> [!quote] å°¤é›¨æºª
> æˆ‘ä»¬ä¹Ÿåœ¨æ¢ç´¢ä¸€ç§æ–°çš„å— Solid å¯å‘çš„ç¼–è¯‘ç­–ç•¥ (Vapor Mode)ï¼Œå®ƒä¸ä¾èµ–äºè™šæ‹Ÿ DOMï¼Œè€Œæ˜¯æ›´å¤šåœ°åˆ©ç”¨ Vue çš„å†…ç½®å“åº”æ€§ç³»ç»Ÿã€‚  

æˆ‘ä»¬å§‘ä¸”ä¸ææ€§èƒ½ï¼Œè‡³å°‘æ˜¯ vue å¯¹å‰ç«¯æ¡†æ¶æ–°æ—¶ä»£çš„æ¢ç´¢ï¼Œæ˜¯æœ‰å†å²æ„ä¹‰å’Œå†ç¨‹æ„ä¹‰çš„ã€‚

> [!important] æœªæ¥åœ¨å†™
> ç”±äº vue çš„ vapor mode è™½ç„¶å¼€å‘è¿›ç¨‹å·²ç»è¶‹äºç»“æŸï¼Œä½†æ˜¯æ€»ä½“è€Œè¨€å¯¹äºæ•´ä½“ api è¿˜æœ‰å¤§é‡å°šæœªç¡®å®šçš„åœ°æ–¹ï¼Œè¿™é‡Œå°±ä¸å¤šåšè§£æäº†ã€‚

### solid.js

ç®€ç§° solidï¼Œsolid æœ¬èº«æ˜¯ <u>åŸºäºç¼–è¯‘çš„å“åº”å¼ç³»ç»Ÿ</u>ï¼Œå¾ˆå¤šäººè¯´ä»–ä¸ç®—æ¨¡æ¿ï¼Œå¯¹æ­¤æˆ‘çš„è§‚ç‚¹è¿˜æ˜¯ï¼š

> [!note] è¿œè¿œä¸ç®—çµæ´»çš„ jsx
>æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåˆ©ç”¨ jsx ä½œä¸ºç¼–è¯‘æ‰‹æ®µçš„ç‰¹æ®Šæ¨¡æ¿ã€‚

äº‹å®ä¸Šï¼Œå¦‚æœ **ä¸ä½¿ç”¨æ¨¡æ¿**ï¼Œè¦å®Œå…¨å®ç°è‡ªåŠ¨æŠ“å–æ›´æ–°æ˜¾ç„¶æ˜¯ä¸€ä¸ª *éå¸¸å›°éš¾ä¸”ç¹ç* çš„äº‹æƒ…ï¼Œä¸‹é¢ä¸¤ä¸ªäºŒé€‰ä¸€:

+ è‡ªå·±æ‰‹åŠ¨å®ç°
+ ç¼–è¯‘å™¨é­”æ³• ğŸª„

è¿™ç‚¹å¹³è¡¡ä¸Š solid åšçš„æ˜¯ç›¸å½“ä¸é”™çš„ã€‚

ä¸å…¶è¯´ solid æ˜¯ react çš„ reactive ç‰ˆæœ¬ï¼Œä¸å¦‚è¯´æ›´åƒæ˜¯ ***å®Œå–„ jsx ç‰ˆæœ¬çš„ vue***ã€‚

solid çš„å“åº”å¼ç³»ç»Ÿæ˜¯é­”æ³•ç¨‹åº¦æœ€ä½çš„ï¼Œä¹Ÿæ˜¯æœ€å¥½ç†è§£çš„ã€‚

å¾ˆå¤šè§£ææ–‡ç« éƒ½è¯•å›¾å°† solid çš„å®ç°å½’åŠŸäº proxy çš„ä½¿ç”¨ï¼Œä½†æˆ‘è¦è¯´æ˜çš„æ˜¯ï¼š solid ä»…ä»…åªåœ¨éƒ¨åˆ†ç³»ç»Ÿä¸Šä½¿ç”¨äº† proxyï¼Œè€Œ solid çš„æ ¸å¿ƒå“åº”å¼ç³»ç»Ÿæ˜¯åŸºäº ***æœ€æœ€åŸå§‹çš„å‘å¸ƒè®¢é˜…è€…æ¨¡å‹*** æ¥å®ç°çš„ã€‚

solid çš„å“åº”å¼ç³»ç»ŸåŸºäº SignalState å’Œ Computation å®ç°, å¦‚æœè¦è¯¦ç»†è®²æ•´ä¸ª solid çš„å®ç°è¿™å°±å¤ªé•¿äº†ï¼Œè¿™é‡Œä¸å¤šèµ˜è¿°ï¼Œåé¢å¯ä»¥å•ç‹¬å‡ºä¸€ä¸ªåŸç†è§£æï¼Œå½“ç„¶åœ¨æ­¤å¤„å¯ä»¥å…ˆè·³è¿‡ã€‚

ä»–çš„æ ¸å¿ƒé€»è¾‘æ˜¯é€šè¿‡åœ¨ æ¸²æŸ“ dom æ—¶é€šè¿‡è®¿é—®å™¨è®¿é—®æ•°æ®æ¥åˆ›å»ºè®¢é˜…è€…ï¼Œéšååœ¨æ•°æ®è¢«ä¿®æ”¹åï¼Œé€šè¿‡å‘å¸ƒæ¥é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…åˆ·æ–°å¯¹åº”çš„ä»£ç ã€‚

è­¬å¦‚è¿™æ ·ä¸€ä¸ªä»£ç ï¼š

```ts
function Counter() {
  const [count, setCount] = createSignal(1);
  const increment = () => setCount(count => count + 1);

  return (
    <button type="button" onClick={increment}>
      {count()}
    </button>
  );
}
```

ä¼šç¼–è¯‘æˆä¸‹é¢è¿™æ ·

```js
function Counter() {
  const [count, setCount] = createSignal(1);
  const increment = () => setCount(count => count + 1);
  return (() => {
    var _el$ = _tmpl$();
    _el$.$$click = increment;
    _$insert(_el$, count);
    return _el$;
  })();
}
```

åªè¦å¯¹ dom æ“ä½œçš„ api æä¾› trackï¼ˆè¿›è¡Œè®¢é˜…ï¼‰[^7] å°±å¯ä»¥çŸ¥é“ä»€ä¹ˆæ—¶å€™å¯ä»¥é‡æ–°è·‘è¿™ä¸€ä¸ªæ“ä½œäº†

# ç»“è¯­

æœ€åé™„ä¸€ä¸ªä¸‹è½½é‡

| åŒ…        |         ä¸‹è½½é‡ |
| -------- | ----------: |
| vue      | 335,318,462 |
| svelte   |  70,866,297 |
| solid-js |  13,551,967 |




[^1]: Spinellis, Diomidis (2007). "Another level of indirection". In Oram, Andy; Wilson, Greg (eds.).Â [_Beautiful Code: Leading Programmers Explain How They Think_](http://www.dmst.aueb.gr/dds/pubs/inbook/beautiful_code/html/Spi07g.html). Sebastopol, California: O'Reilly and Associates. pp.Â 279â€“291.
[^2]: https://www.uber.com/en-HK/blog/m-uber/
[^3]: æºäºã€ŠJOJOçš„å¥‡å¦™å†’é™©ã€‹æ¼«ç”»ç¬¬äºŒå·ç¬¬31é¡µï¼ˆåŠ¨ç”»ç¬¬ä¸€éƒ¨ç¬¬ä¸‰é›†ï¼‰ã€‚
[^4]: https://www.youtube.com/watch?reload=9&v=x7cQ3mrcKaY
[^5]: https://zhuanlan.zhihu.com/p/23752826
[^6]: https://juejin.cn/live/xdc202201
[^7]: ä¸Šæ–‡ä¸­ä»£ç é‡Œé¢çš„ `_$insert`