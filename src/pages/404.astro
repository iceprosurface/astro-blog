---
import BaseLayout from "../layouts/BaseLayout.astro";
import GameManager from "../components/games/GameManager";
import { Home, Gamepad2, RotateCcw } from "lucide-react";
---

<BaseLayout
    title="404 - 页面未找到"
    description="您访问的页面不存在，可以在这里玩个小游戏。"
    showRightSidebar={false}
>
    <div class="error-container">
        <div class="error-wrapper">
            <div id="error-content" class="error-content">
                <div class="error-header">
                    <h1>404</h1>
                    <p>页面未找到</p>
                    <p class="sub-text">
                        你访问的页面不存在，不如来玩个小游戏？
                    </p>
                </div>

                <div class="error-actions">
                    <a href="/" class="action-btn home-btn">
                        <Home size={20} />
                        <span>返回首页</span>
                    </a>
                    <button id="play-btn" class="action-btn play-btn">
                        <Gamepad2 size={20} />
                        <span>来一把</span>
                    </button>
                </div>
            </div>

            <div
                id="game-container"
                class="game-container"
                style="display: none;"
            >
                <div class="game-header">
                    <a href="/" class="back-home">
                        <Home size={16} />
                        <span>返回首页</span>
                    </a>
                    <button id="restart-btn" class="restart-btn">
                        <RotateCcw size={16} />
                        <span>换个游戏</span>
                    </button>
                </div>
                <GameManager client:load />
            </div>
        </div>
    </div>

    <script>
        const playBtn = document.getElementById("play-btn");
        const restartBtn = document.getElementById("restart-btn");
        const errorContent = document.getElementById("error-content");
        const gameContainer = document.getElementById("game-container");

        playBtn?.addEventListener("click", () => {
            errorContent?.classList.add("fade-out");
            setTimeout(() => {
                errorContent?.classList.add("hidden");
                gameContainer?.classList.add("fade-in");
                gameContainer!.style.display = "block";
                // Toggle game start
                window.dispatchEvent(new CustomEvent("play-game"));
            }, 300);
        });

        restartBtn?.addEventListener("click", () => {
            window.dispatchEvent(new CustomEvent("restart-game"));
        });
    </script>
</BaseLayout>

<style>
    .error-container {
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        padding: 2rem;
    }

    .error-wrapper {
        width: 100%;
        max-width: 800px;
    }

    .error-content {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        transition: opacity 0.3s ease;
    }

    .error-content.fade-out {
        opacity: 0;
    }

    .error-content.hidden {
        display: none;
    }

    .error-header h1 {
        font-size: 8rem;
        font-weight: 700;
        margin: 0;
        color: #333;
        line-height: 1;
        letter-spacing: -4px;
    }

    .error-header > p {
        font-size: 1.5rem;
        margin: 1.5rem 0 0.75rem 0;
        color: #666;
        font-weight: 500;
    }

    .sub-text {
        font-size: 1rem !important;
        color: #999 !important;
        font-weight: 400 !important;
        margin-bottom: 2.5rem !important;
    }

    .error-actions {
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
        justify-content: center;
    }

    .action-btn {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.875rem 1.5rem;
        border: none;
        border-radius: 8px;
        font-size: 0.9375rem;
        font-weight: 500;
        cursor: pointer;
        transition:
            background-color 0.2s ease,
            transform 0.1s ease;
        text-decoration: none;
    }

    .action-btn:hover {
        transform: translateY(-2px);
    }

    .action-btn:active {
        transform: translateY(0);
    }

    .home-btn {
        background-color: #f3f4f6;
        color: #374151;
    }

    .home-btn:hover {
        background-color: #e5e7eb;
    }

    .play-btn {
        background-color: #333;
        color: #fff;
    }

    .play-btn:hover {
        background-color: #111;
    }

    .game-container {
        animation: fadeIn 0.3s ease;
    }

    .game-container.fade-in {
        animation: fadeIn 0.3s ease forwards;
    }

    .game-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem 1.5rem;
        border-bottom: 1px solid #e5e7eb;
        margin-bottom: 0;
    }

    .back-home,
    .restart-btn {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.5rem 1rem;
        background: #f3f4f6;
        border: none;
        border-radius: 6px;
        color: #374151;
        font-size: 0.875rem;
        font-weight: 500;
        cursor: pointer;
        transition:
            background-color 0.2s ease,
            transform 0.1s ease;
        text-decoration: none;
    }

    .back-home:hover,
    .restart-btn:hover {
        background-color: #e5e7eb;
    }

    .back-home:active,
    .restart-btn:active {
        transform: translateY(0);
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @media (max-width: 600px) {
        .error-header h1 {
            font-size: 6rem;
        }

        .error-actions {
            flex-direction: column;
            width: 100%;
        }

        .action-btn {
            width: 100%;
            justify-content: center;
        }

        .game-header {
            flex-direction: column;
            gap: 1rem;
        }

        .back-home,
        .restart-btn {
            width: 100%;
            justify-content: center;
        }
    }
</style>

<style is:global>
    .game-manager {
        width: 100%;
        height: 100%;
    }

    .game-container {
        width: 100%;
        height: 100%;
        background: #fafafa;
        border-radius: 0;
        overflow: hidden;
        position: relative;
    }

    .game-container canvas {
        display: block;
        width: 100%;
        height: 100%;
    }

    .game-info {
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .score {
        font-size: 0.9375rem;
        color: #666;
        font-weight: 500;
    }
</style>
